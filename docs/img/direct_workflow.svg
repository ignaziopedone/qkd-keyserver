<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1422px" preserveAspectRatio="none" style="width:1171px;height:1422px;background:#FFFFFF;" version="1.1" viewBox="0 0 1171 1422" width="1171px" zoomAndPan="magnify"><defs><filter height="300%" id="f1betiulkx8amr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="44.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="221.9609"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="248.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="486.4219"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="262.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="897.4141"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="88.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="177.6953"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="73.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="515.5547"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="926.5469"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="1101.3438"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="88.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="310.4922"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="58.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="647.2188"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="1013.9453"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="1262.1406"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="44.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="354.7578"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="116.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="618.0859"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="984.8125"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="1233.0078"/><rect fill="#FFFFFF" filter="url(#f1betiulkx8amr)" height="61.3984" style="stroke:#000000;stroke-width:2.0;" width="299" x="423" y="749.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="88.2969" y2="1338.4063"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="274" x2="274" y1="88.2969" y2="1338.4063"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="489" x2="489" y1="88.2969" y2="1338.4063"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="659" x2="659" y1="88.2969" y2="1338.4063"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="911" x2="911" y1="88.2969" y2="1338.4063"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1120" x2="1120" y1="88.2969" y2="1338.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="5" y="84.9951">Alice's SAE</text><ellipse cx="47" cy="15" fill="#F08080" filter="url(#f1betiulkx8amr)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M47,23 L47,50 M34,31 L60,31 M47,50 L34,65 M47,50 L60,65 " fill="none" filter="url(#f1betiulkx8amr)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="5" y="1350.4014">Alice's SAE</text><ellipse cx="47" cy="1363.7031" fill="#F08080" filter="url(#f1betiulkx8amr)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M47,1371.7031 L47,1398.7031 M34,1379.7031 L60,1379.7031 M47,1398.7031 L34,1413.7031 M47,1398.7031 L60,1413.7031 " fill="none" filter="url(#f1betiulkx8amr)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="225" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="232" y="72.9951">Alice's QKS</text><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="225" y="1337.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="232" y="1357.4014">Alice's QKS</text><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="108" x="433" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="440" y="72.9951">Alice's QKDM</text><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="108" x="433" y="1337.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="440" y="1357.4014">Alice's QKDM</text><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="102" x="606" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="613" y="72.9951">Bob's QKDM</text><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="102" x="606" y="1337.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="613" y="1357.4014">Bob's QKDM</text><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="865" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="872" y="72.9951">Bob's QKS</text><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="865" y="1337.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="872" y="1357.4014">Bob's QKS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1081" y="84.9951">Bob's SAE</text><ellipse cx="1120" cy="15" fill="#F08080" filter="url(#f1betiulkx8amr)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1120,23 L1120,50 M1107,31 L1133,31 M1120,50 L1107,65 M1120,50 L1133,65 " fill="none" filter="url(#f1betiulkx8amr)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="1081" y="1350.4014">Bob's SAE</text><ellipse cx="1120" cy="1363.7031" fill="#F08080" filter="url(#f1betiulkx8amr)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1120,1371.7031 L1120,1398.7031 M1107,1379.7031 L1133,1379.7031 M1120,1398.7031 L1107,1413.7031 M1120,1398.7031 L1133,1413.7031 " fill="none" filter="url(#f1betiulkx8amr)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="44.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="221.9609"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="248.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="486.4219"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="262.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="897.4141"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="88.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="177.6953"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="73.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="515.5547"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="926.5469"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="484" y="1101.3438"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="88.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="310.4922"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="58.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="647.2188"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="1013.9453"/><rect fill="#90EE90" filter="url(#f1betiulkx8amr)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="654" y="1262.1406"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="44.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="354.7578"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="116.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="618.0859"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="984.8125"/><rect fill="#ADD8E6" filter="url(#f1betiulkx8amr)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="906" y="1233.0078"/><rect fill="#EEEEEE" filter="url(#f1betiulkx8amr)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1164" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1164" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1164" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#f1betiulkx8amr)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="228" x="468" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="209" x="474" y="124.3638">a) QKD module registration</text><polygon fill="#008000" points="472,173.6953,482,177.6953,472,181.6953,476,177.6953" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="0" x2="478" y1="177.6953" y2="177.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="119.5" y="165.063">1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93" x="209" y="157.4966">from admin:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="150.5" y="172.6294">attach_to_server( {server info} )</text><polygon fill="#0000FF" points="290,217.9609,280,221.9609,290,225.9609,286,221.9609" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="284" x2="483" y1="221.9609" y2="221.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="312" y="209.3286">1.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="349.5" y="201.7622">registerQKDM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="339" y="216.895">( {module info} )</text><polygon fill="#0000FF" points="477,262.2266,487,266.2266,477,270.2266,481,266.2266" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="274" x2="483" y1="266.2266" y2="266.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="302" y="253.5942">1.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="328" y="246.0278">&lt; environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="359.5" y="261.1606">for QKDM &gt;</text><polygon fill="#008000" points="675,306.4922,665,310.4922,675,314.4922,671,310.4922" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="669" x2="1163" y1="310.4922" y2="310.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="791.5" y="297.8599">1.4</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="93" x="881" y="290.2935">from admin:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="822.5" y="305.4263">attach_to_server( {server info} )</text><polygon fill="#0000FF" points="894,350.7578,904,354.7578,894,358.7578,898,354.7578" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="664" x2="900" y1="354.7578" y2="354.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="715.5" y="342.1255">1.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="753" y="334.5591">registerQKDM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="742.5" y="349.6919">( {module info} )</text><polygon fill="#0000FF" points="670,395.0234,660,399.0234,670,403.0234,666,399.0234" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="664" x2="910" y1="399.0234" y2="399.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="705" y="386.3911">1.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="732" y="378.8247">&lt; environment data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="761.5" y="393.9575">for QKDM &gt;</text><rect fill="#EEEEEE" filter="url(#f1betiulkx8amr)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1164" x="0" y="427.5898"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1164" y1="427.5898" y2="427.5898"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1164" y1="430.5898" y2="430.5898"/><rect fill="#EEEEEE" filter="url(#f1betiulkx8amr)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="195" x="484.5" y="417.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="176" x="490.5" y="433.0903">b) Key stream creation</text><polygon fill="#0000FF" points="257,482.4219,267,486.4219,257,490.4219,261,486.4219" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="0" x2="263" y1="486.4219" y2="486.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="23.5" y="473.7896">2.1</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88" x="102" y="466.2231">from admin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="194" y="466.2231"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="54.5" y="481.356">startQKDMStream( QKDM_ID )</text><polygon fill="#008000" points="472,511.5547,482,515.5547,472,519.5547,476,515.5547" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="279" x2="478" y1="515.5547" y2="515.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="288.5" y="510.4888">2.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="315.5" y="510.4888">open_connect ( src, dst )</text><polygon fill="#008000" points="647,555.8203,657,559.8203,647,563.8203,651,559.8203" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="494" x2="653" y1="559.8203" y2="559.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="508.5" y="547.188">2.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="545" y="539.6216">open_stream</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="538.5" y="554.7544">(  src, dst, KSID )</text><polygon fill="#008000" points="290,584.9531,280,588.9531,290,592.9531,286,588.9531" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="488" y1="588.9531" y2="588.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="342" y="583.8872">2.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="369" y="583.8872">&lt; KSID &gt;</text><polygon fill="#0000FF" points="894,614.0859,904,618.0859,894,622.0859,898,618.0859" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="279" x2="900" y1="618.0859" y2="618.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="479.5" y="613.02">2.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="506.5" y="613.02">createStream ( src, KSID, type)</text><polygon fill="#008000" points="675,643.2188,665,647.2188,675,651.2188,671,647.2188" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="669" x2="905" y1="647.2188" y2="647.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="673.5" y="642.1528">2.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="700.5" y="642.1528">open_connect ( src, dst, KSID )</text><polygon fill="#008000" points="500,672.3516,490,676.3516,500,680.3516,496,676.3516" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="494" x2="653" y1="676.3516" y2="676.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="501" y="671.2856">2.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="528" y="671.2856">exchange ( KSID )</text><polygon fill="#008000" points="894,701.4844,904,705.4844,894,709.4844,898,705.4844" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="659" x2="900" y1="705.4844" y2="705.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="740.5" y="700.4185">2.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="767.5" y="700.4185">&lt; KSID &gt;</text><polygon fill="#0000FF" points="285,730.6172,275,734.6172,285,738.6172,281,734.6172" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="910" y1="734.6172" y2="734.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="556" y="729.5513">2.9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="583" y="729.5513">&lt; OK &gt;</text><path d="M423,749.6172 L501,749.6172 L501,756.6172 L491,766.6172 L423,766.6172 L423,749.6172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="61.3984" style="stroke:#000000;stroke-width:2.0;" width="299" x="423" y="749.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="438" y="762.6841">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="516" y="761.8276">[exchange keys]</text><polygon fill="#008000" points="500,799.0156,490,803.0156,500,807.0156,496,803.0156" style="stroke:#008000;stroke-width:1.0;"/><polygon fill="#008000" points="647,799.0156,657,803.0156,647,807.0156,651,803.0156" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="494" x2="653" y1="803.0156" y2="803.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="506" y="790.3833">2.10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="555.5" y="782.8169">continuous</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="547" y="797.9497">QKD exchange</text><rect fill="#EEEEEE" filter="url(#f1betiulkx8amr)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1164" x="0" y="838.582"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1164" y1="838.582" y2="838.582"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1164" y1="841.582" y2="841.582"/><rect fill="#EEEEEE" filter="url(#f1betiulkx8amr)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="129" x="517.5" y="828.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="110" x="523.5" y="844.0825">c) Key request</text><polygon fill="#0000FF" points="257,893.4141,267,897.4141,257,901.4141,261,897.4141" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="47" x2="263" y1="897.4141" y2="897.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="56.5" y="884.7817">3.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="146.5" y="877.2153">getKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="86.5" y="892.3481">(slave_SAE_ID, size, count)</text><polygon fill="#008000" points="472,922.5469,482,926.5469,472,930.5469,476,926.5469" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="279" x2="478" y1="926.5469" y2="926.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="311.5" y="921.481">3.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="337.5" y="921.481">get_key_ID (KSID)</text><polygon fill="#008000" points="290,951.6797,280,955.6797,290,959.6797,286,955.6797" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="488" y1="955.6797" y2="955.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="343.5" y="950.6138">3.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="368.5" y="950.6138">&lt; KIDs &gt;</text><polygon fill="#0000FF" points="894,980.8125,904,984.8125,894,988.8125,898,984.8125" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="279" x2="900" y1="984.8125" y2="984.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="370" y="979.7466">3.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419" x="396" y="979.7466">reserveKeys ( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )</text><polygon fill="#008000" points="675,1009.9453,665,1013.9453,675,1017.9453,671,1013.9453" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="669" x2="905" y1="1013.9453" y2="1013.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="689" y="1008.8794">3.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="715" y="1008.8794">check_key_ID (KSID, KIDs)</text><polygon fill="#008000" points="894,1039.0781,904,1043.0781,894,1047.0781,898,1043.0781" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="659" x2="900" y1="1043.0781" y2="1043.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="746.5" y="1038.0122">3.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="772.5" y="1038.0122">&lt; OK &gt;</text><polygon fill="#0000FF" points="290,1068.2109,280,1072.2109,290,1076.2109,286,1072.2109" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="910" y1="1072.2109" y2="1072.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="559" y="1067.145">3.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="585" y="1067.145">&lt; OK &gt;</text><polygon fill="#008000" points="472,1097.3438,482,1101.3438,472,1105.3438,476,1101.3438" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="279" x2="478" y1="1101.3438" y2="1101.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="303.5" y="1096.2778">3.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="329.5" y="1096.2778">get_key (KSID, KIDs)</text><polygon fill="#008000" points="290,1126.4766,280,1130.4766,290,1134.4766,286,1130.4766" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="284" x2="488" y1="1130.4766" y2="1130.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="324" y="1125.4106">3.9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="350" y="1125.4106">&lt; keys, KIDs &gt;</text><polygon fill="#0000FF" points="58,1155.6094,48,1159.6094,58,1163.6094,54,1159.6094" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="273" y1="1159.6094" y2="1159.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="98" y="1154.5435">3.10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="134" y="1154.5435">&lt; AKID, key &gt;</text><polygon fill="#FF0000" points="1108,1184.7422,1118,1188.7422,1108,1192.7422,1112,1188.7422" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="47" x2="1114" y1="1188.7422" y2="1188.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="530" y="1183.6763">3.11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="565" y="1183.6763">send AKIDs</text><polygon fill="#0000FF" points="927,1229.0078,917,1233.0078,927,1237.0078,923,1233.0078" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="921" x2="1119" y1="1233.0078" y2="1233.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="925.5" y="1220.3755">3.12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="974.5" y="1212.8091">getKeyWithKeyIDs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="964.5" y="1227.9419">(master_SAE_ID, AKID)</text><polygon fill="#008000" points="675,1258.1406,665,1262.1406,675,1266.1406,671,1262.1406" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="669" x2="905" y1="1262.1406" y2="1262.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="703" y="1257.0747">3.13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="737" y="1257.0747">get_key (KSID, KIDs)</text><polygon fill="#008000" points="894,1287.2734,904,1291.2734,894,1295.2734,898,1291.2734" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="659" x2="900" y1="1291.2734" y2="1291.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="718" y="1286.2075">3.14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="753" y="1286.2075">&lt; keys, KIDs &gt;</text><polygon fill="#0000FF" points="1108,1316.4063,1118,1320.4063,1108,1324.4063,1112,1320.4063" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="911" x2="1114" y1="1320.4063" y2="1320.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="953.5" y="1315.3403">3.15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="988.5" y="1315.3403">&lt; AKID, key &gt;</text><!--MD5=[4ff2909a0342bf87742afc7f24cd3532]
@startuml
skinparam sequenceMessageAlign center
actor "Alice's SAE" as ASAE order 2 #lightCoral
actor "Bob's SAE" as BSAE order 7 #lightCoral
participant "Alice's QKS" as AQKS order 3 #LightBlue
participant "Bob's QKS" as BQKS order 6 #LightBlue
participant "Alice's QKDM" as AQM order 4 #LightGreen
participant "Bob's QKDM" as BQM order 5 #LightGreen

== a) QKD module registration ==
autonumber 1.1
 [-[#green]> AQM ++ #LightGreen:**from admin:**\n attach_to_server( {server info} ) 
AQM -[#blue]> AQKS ++ #LightBlue: registerQKDM \n( {module info} )
AQKS -[#blue]-> AQM - -: < environment data \n for QKDM >
deactivate AQM
BQM <[#green]-] ++ #Lightgreen: **from admin:**\n attach_to_server( {server info} )
BQM -[#blue]> BQKS ++ #LightBlue: registerQKDM \n( {module info} )
BQKS -[#blue]-> BQM - -:  < environment data \nfor QKDM >
deactivate BQM

== b) Key stream creation == 
autonumber inc A

[-[#blue]> AQKS ++ #lightblue: **from admin** \n startQKDMStream( QKDM_ID )
AQKS -[#green]> AQM ++ #lightgreen: open_connect ( src, dst )
AQM -[#green]> BQM : open_stream \n (  src, dst, KSID )
AQM - -[#green]> AQKS - -: < KSID >
AQKS -[#blue]> BQKS ++ #lightblue: createStream ( src, KSID, type) 
BQKS -[#green]> BQM ++ #lightgreen: open_connect ( src, dst, KSID ) 
BQM -[#green]> AQM : exchange ( KSID )
BQM - -[#green]> BQKS - - : < KSID >
BQKS - -[#blue]> AQKS - - : < OK >
deactivate AQKS

loop exchange keys
    AQM <-[#green]-> BQM : continuous \n QKD exchange
end


== c) Key request == 
autonumber inc A

ASAE -[#blue]> AQKS ++ #LightBlue: getKey \n (slave_SAE_ID, size, count) 
AQKS -[#green]> AQM ++ #LightGreen: get_key_ID (KSID)
AQM -[#green]->AQKS - -: < KIDs > 
AQKS -[#blue]> BQKS ++ #LightBlue: reserveKeys ( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} ) 
BQKS -[#green]> BQM ++ #LightGreen: check_key_ID (KSID, KIDs)
BQM -[#green]-> BQKS - - : < OK >
BQKS -[#blue]-> AQKS - -: < OK >
AQKS -[#green]> AQM ++ #LightGreen: get_key (KSID, KIDs) 
AQM -[#green]-> AQKS - -: < keys, KIDs >
AQKS -[#blue]-> ASAE - -: < AKID, key >

ASAE -[#red]> BSAE :  send AKIDs  
BSAE -[#blue]> BQKS ++ #LightBlue: getKeyWithKeyIDs \n (master_SAE_ID, AKID)
BQKS -[#green]> BQM ++ #LightGreen: get_key (KSID, KIDs) 
BQM -[#green]-> BQKS - -: < keys, KIDs > 
BQKS -[#blue]-> BSAE - - :  < AKID, key >
@enduml

PlantUML version 1.2021.11beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>