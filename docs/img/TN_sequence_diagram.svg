<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="880px" preserveAspectRatio="none" style="width:1332px;height:880px;background:#FFFFFF;" version="1.1" viewBox="0 0 1332 880" width="1332px" zoomAndPan="magnify"><defs><filter height="300%" id="f1fwa9tr58kfwi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="272.7617" style="stroke:#A80036;stroke-width:1.0;" width="10" x="302.5" y="175.1289"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="41.6992" style="stroke:#A80036;stroke-width:1.0;" width="10" x="307.5" y="311.793"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="170.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="302.5" y="520.1563"/><rect fill="#87CEFA" filter="url(#f1fwa9tr58kfwi)" height="112.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="650.5" y="270.0938"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="201.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="216.8281"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="41.6992" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="561.8555"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="632.6875"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="749.2188"/><rect fill="#FFFFFF" filter="url(#f1fwa9tr58kfwi)" height="158.7969" style="stroke:#000000;stroke-width:2.0;" width="789" x="257" y="231.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="88.2969" y2="796.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="307" x2="307" y1="88.2969" y2="796.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="655" x2="655" y1="88.2969" y2="796.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="997" x2="997" y1="88.2969" y2="796.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1288" x2="1288" y1="88.2969" y2="796.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="5" y="84.9951">aliceSAE</text><ellipse cx="38.5" cy="15" fill="#F08080" filter="url(#f1fwa9tr58kfwi)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M38.5,23 L38.5,50 M25.5,31 L51.5,31 M38.5,50 L25.5,65 M38.5,50 L51.5,65 " fill="none" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="5" y="808.3467">aliceSAE</text><ellipse cx="38.5" cy="821.6484" fill="#F08080" filter="url(#f1fwa9tr58kfwi)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M38.5,829.6484 L38.5,856.6484 M25.5,837.6484 L51.5,837.6484 M38.5,856.6484 L25.5,871.6484 M38.5,856.6484 L51.5,871.6484 " fill="none" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="77" x="267" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="274" y="72.9951">aliceQKS</text><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="77" x="267" y="795.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="274" y="815.3467">aliceQKS</text><rect fill="#87CEFA" filter="url(#f1fwa9tr58kfwi)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="79" x="614" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="621" y="72.9951">carolQKS</text><rect fill="#87CEFA" filter="url(#f1fwa9tr58kfwi)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="79" x="614" y="795.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="621" y="815.3467">carolQKS</text><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="73" x="959" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="966" y="72.9951">bobQKS</text><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="73" x="959" y="795.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="966" y="815.3467">bobQKS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1257" y="84.9951">bobSAE</text><ellipse cx="1288.5" cy="15" fill="#F08080" filter="url(#f1fwa9tr58kfwi)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1288.5,23 L1288.5,50 M1275.5,31 L1301.5,31 M1288.5,50 L1275.5,65 M1288.5,50 L1301.5,65 " fill="none" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1257" y="808.3467">bobSAE</text><ellipse cx="1288.5" cy="821.6484" fill="#F08080" filter="url(#f1fwa9tr58kfwi)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1288.5,829.6484 L1288.5,856.6484 M1275.5,837.6484 L1301.5,837.6484 M1288.5,856.6484 L1275.5,871.6484 M1288.5,856.6484 L1301.5,871.6484 " fill="none" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="272.7617" style="stroke:#A80036;stroke-width:1.0;" width="10" x="302.5" y="175.1289"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="41.6992" style="stroke:#A80036;stroke-width:1.0;" width="10" x="307.5" y="311.793"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="170.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="302.5" y="520.1563"/><rect fill="#87CEFA" filter="url(#f1fwa9tr58kfwi)" height="112.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="650.5" y="270.0938"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="201.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="216.8281"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="41.6992" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="561.8555"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="632.6875"/><rect fill="#ADD8E6" filter="url(#f1fwa9tr58kfwi)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="992.5" y="749.2188"/><rect fill="#EEEEEE" filter="url(#f1fwa9tr58kfwi)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1325" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1325" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1325" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#f1fwa9tr58kfwi)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="207" x="559" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188" x="565" y="124.3638">Indirect stream creation</text><polygon fill="#0000FF" points="290.5,171.1289,300.5,175.1289,290.5,179.1289,294.5,175.1289" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="38.5" x2="296.5" y1="175.1289" y2="175.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="94.5" y="170.063">1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="121.5" y="170.063">getStatus (bobSAE)</text><path d="M317,146.4297 L317,186.4297 L541,186.4297 L541,156.4297 L531,146.4297 L317,146.4297 " fill="#FBFB77" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M531,146.4297 L531,156.4297 L541,156.4297 L531,146.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="323" y="163.4966">bobSAE non directly connected</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="327" y="178.6294">keyStream not found</text><polygon fill="#0000FF" points="980.5,212.8281,990.5,216.8281,980.5,220.8281,984.5,216.8281" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="312.5" x2="986.5" y1="216.8281" y2="216.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="498.5" y="211.7622">1.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="525.5" y="211.7622">createStream ( src, KSID, type, master_KID)</text><path d="M257,231.8281 L385,231.8281 L385,238.8281 L375,248.8281 L257,248.8281 L257,231.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.7969" style="stroke:#000000;stroke-width:2.0;" width="789" x="257" y="231.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="272" y="244.895">forwarding</text><polygon fill="#0000FF" points="671.5,266.0938,661.5,270.0938,671.5,274.0938,667.5,270.0938" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="665.5" x2="991.5" y1="270.0938" y2="270.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="670" y="265.0278">1.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="696" y="265.0278">forwardData (enc_data, next_hop, dest, KID)</text><polygon fill="#0000FF" points="328.5,307.793,318.5,311.793,328.5,315.793,324.5,311.793" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="322.5" x2="649.5" y1="311.793" y2="311.793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="327" y="306.7271">1.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="354" y="306.7271">forwardData (enc_data, next_hop, dest, KID)</text><path d="M665,283.0938 L665,323.0938 L849,323.0938 L849,293.0938 L839,283.0938 L665,283.0938 " fill="#FBFB77" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M839,283.0938 L839,293.0938 L849,293.0938 L839,283.0938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="671" y="300.1606">enc_data encrypted with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="675" y="315.2935">a QKD derived key</text><polygon fill="#0000FF" points="638.5,349.4922,648.5,353.4922,638.5,357.4922,642.5,353.4922" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="312.5" x2="644.5" y1="353.4922" y2="353.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="445" y="348.4263">1.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="472" y="348.4263">&lt; OK &gt;</text><polygon fill="#0000FF" points="980.5,378.625,990.5,382.625,980.5,386.625,984.5,382.625" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="655.5" x2="986.5" y1="382.625" y2="382.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="787.5" y="377.5591">1.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="814.5" y="377.5591">&lt; OK &gt;</text><polygon fill="#0000FF" points="323.5,414.7578,313.5,418.7578,323.5,422.7578,319.5,418.7578" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="317.5" x2="996.5" y1="418.7578" y2="418.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="614.5" y="413.6919">1.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="641.5" y="413.6919">&lt; ACK &gt;</text><polygon fill="#0000FF" points="49.5,443.8906,39.5,447.8906,49.5,451.8906,45.5,447.8906" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="306.5" y1="447.8906" y2="447.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="111.5" y="442.8247">1.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="138.5" y="442.8247">&lt; status info &gt;</text><rect fill="#EEEEEE" filter="url(#f1fwa9tr58kfwi)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1325" x="0" y="476.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1325" y1="476.457" y2="476.457"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1325" y1="479.457" y2="479.457"/><rect fill="#EEEEEE" filter="url(#f1fwa9tr58kfwi)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="110" x="607.5" y="465.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="613.5" y="481.9575">Key request</text><polygon fill="#0000FF" points="290.5,516.1563,300.5,520.1563,290.5,524.1563,294.5,520.1563" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="38.5" x2="296.5" y1="520.1563" y2="520.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="48" y="515.0903">2.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="75" y="515.0903">getKey(slave_SAE_ID, size, count)</text><polygon fill="#0000FF" points="980.5,557.8555,990.5,561.8555,980.5,565.8555,984.5,561.8555" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="312.5" x2="986.5" y1="561.8555" y2="561.8555"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="498.5" y="556.7896">2.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="525.5" y="556.7896">exchangeIndirectKey (KSID, KIDs, enc_keys)</text><path d="M108,533.1563 L108,573.1563 L293,573.1563 L293,543.1563 L283,533.1563 L108,533.1563 " fill="#FBFB77" filter="url(#f1fwa9tr58kfwi)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M283,533.1563 L283,543.1563 L293,543.1563 L283,533.1563 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="114" y="550.2231">enc_keys encrypted with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="118" y="565.356">the master key</text><polygon fill="#0000FF" points="323.5,599.5547,313.5,603.5547,323.5,607.5547,319.5,603.5547" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="317.5" x2="996.5" y1="603.5547" y2="603.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="615" y="598.4888">2.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="641" y="598.4888">&lt; ACK &gt;</text><polygon fill="#0000FF" points="980.5,628.6875,990.5,632.6875,980.5,636.6875,984.5,632.6875" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="312.5" x2="986.5" y1="632.6875" y2="632.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="429.5" y="627.6216">2.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419" x="456.5" y="627.6216">reserveKeys ( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )</text><polygon fill="#0000FF" points="323.5,657.8203,313.5,661.8203,323.5,665.8203,319.5,661.8203" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="317.5" x2="996.5" y1="661.8203" y2="661.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="614.5" y="656.7544">2.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="641.5" y="656.7544">&lt; ACK &gt;</text><polygon fill="#0000FF" points="49.5,686.9531,39.5,690.9531,49.5,694.9531,45.5,690.9531" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="306.5" y1="690.9531" y2="690.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="115" y="685.8872">2.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="142" y="685.8872">&lt; AKID, key &gt;</text><polygon fill="#FF0000" points="1276.5,716.0859,1286.5,720.0859,1276.5,724.0859,1280.5,720.0859" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="38.5" x2="1282.5" y1="720.0859" y2="720.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="617.5" y="715.02">2.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="644.5" y="715.02">send AKID</text><polygon fill="#0000FF" points="1013.5,745.2188,1003.5,749.2188,1013.5,753.2188,1009.5,749.2188" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="1007.5" x2="1287.5" y1="749.2188" y2="749.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="1012" y="744.1528">2.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="1039" y="744.1528">getKeyWithIDs(master_SAE_ID, AKID)</text><polygon fill="#0000FF" points="1276.5,774.3516,1286.5,778.3516,1276.5,782.3516,1280.5,778.3516" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="997.5" x2="1282.5" y1="778.3516" y2="778.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="1085" y="773.2856">2.9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1112" y="773.2856">&lt; AKID, key &gt;</text><!--MD5=[2fc6a3214ac723b78b6714322fb641a6]
@startuml
skinparam sequenceMessageAlign center
actor aliceSAE as ASAE order 1  #lightCoral
actor bobSAE as BSAE order 5  #lightCoral
participant aliceQKS as AQKS order 2 #LightBlue
participant bobQKS as BQKS order 4 #LightBlue
participant carolQKS as CQKS order 3 #lightskyblue

== Indirect stream creation == 
autonumber 1.1
ASAE -[#blue]> AQKS ++ #LightBlue: getStatus (bobSAE)
note right: bobSAE non directly connected \n keyStream not found 
AQKS -[#blue]> BQKS ++ #lightblue : createStream ( src, KSID, type, master_KID) 

group forwarding
BQKS -[#blue]> CQKS ++ #lightskyblue: forwardData (enc_data, next_hop, dest, KID) 
CQKS -[#blue]> AQKS ++ #lightblue: forwardData (enc_data, next_hop, dest, KID) 
note right: enc_data encrypted with \n a QKD derived key 
AQKS -[#blue]-> CQKS - -: < OK >
CQKS -[#blue]-> BQKS - -: < OK >
end

BQKS -[#blue]-> AQKS - -: < ACK > 
AQKS -[#blue]-> ASAE - -: < status info >


== Key request == 
autonumber inc A
ASAE -[#blue]> AQKS ++ #LightBlue: getKey(slave_SAE_ID, size, count) 
AQKS -[#blue]> BQKS ++ #LightBlue: exchangeIndirectKey (KSID, KIDs, enc_keys) 
note left: enc_keys encrypted with \n the master key
BQKS -[#blue]-> AQKS - -: < ACK >
AQKS -[#blue]> BQKS ++ #LightBlue:  reserveKeys ( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )
BQKS -[#blue]-> AQKS - -: < ACK >
AQKS -[#blue]-> ASAE - - : < AKID, key >
ASAE -[#red]> BSAE : send AKID
BSAE -[#blue]> BQKS ++ #LightBlue: getKeyWithIDs(master_SAE_ID, AKID)
BQKS -[#blue]-> BSAE - -: < AKID, key >
@enduml

PlantUML version 1.2021.11beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>