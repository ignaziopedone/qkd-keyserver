<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="672px" preserveAspectRatio="none" style="width:1052px;height:672px;background:#FFFFFF;" version="1.1" viewBox="0 0 1052 672" width="1052px" zoomAndPan="magnify"><defs><filter height="300%" id="fpwoh3eyej81u" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="290.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="266" y="177.6953"/><rect fill="#87CEFA" filter="url(#fpwoh3eyej81u)" height="112.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="528" y="246.0938"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="34.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="789" y="295.3594"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="789" y="409.8906"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="789" y="541.5547"/><rect fill="#FFFFFF" filter="url(#fpwoh3eyej81u)" height="173.9297" style="stroke:#000000;stroke-width:2.0;" width="790" x="212" y="192.6953"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="88.2969" y2="588.6875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="271" x2="271" y1="88.2969" y2="588.6875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="533" x2="533" y1="88.2969" y2="588.6875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="794" x2="794" y1="88.2969" y2="588.6875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1001" x2="1001" y1="88.2969" y2="588.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="5" y="84.9951">Alice's SAE</text><ellipse cx="47" cy="15" fill="#F08080" filter="url(#fpwoh3eyej81u)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M47,23 L47,50 M34,31 L60,31 M47,50 L34,65 M47,50 L60,65 " fill="none" filter="url(#fpwoh3eyej81u)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="5" y="600.6826">Alice's SAE</text><ellipse cx="47" cy="613.9844" fill="#F08080" filter="url(#fpwoh3eyej81u)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M47,621.9844 L47,648.9844 M34,629.9844 L60,629.9844 M47,648.9844 L34,663.9844 M47,648.9844 L60,663.9844 " fill="none" filter="url(#fpwoh3eyej81u)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="222" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="229" y="72.9951">Alice's QKS</text><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="222" y="587.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="229" y="607.6826">Alice's QKS</text><rect fill="#87CEFA" filter="url(#fpwoh3eyej81u)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="483" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="490" y="72.9951">Carol's QKS</text><rect fill="#87CEFA" filter="url(#fpwoh3eyej81u)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="483" y="587.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="490" y="607.6826">Carol's QKS</text><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="748" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="755" y="72.9951">Bob's QKS</text><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="748" y="587.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="755" y="607.6826">Bob's QKS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="962" y="84.9951">Bob's SAE</text><ellipse cx="1001" cy="15" fill="#F08080" filter="url(#fpwoh3eyej81u)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1001,23 L1001,50 M988,31 L1014,31 M1001,50 L988,65 M1001,50 L1014,65 " fill="none" filter="url(#fpwoh3eyej81u)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="962" y="600.6826">Bob's SAE</text><ellipse cx="1001" cy="613.9844" fill="#F08080" filter="url(#fpwoh3eyej81u)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1001,621.9844 L1001,648.9844 M988,629.9844 L1014,629.9844 M1001,648.9844 L988,663.9844 M1001,648.9844 L1014,663.9844 " fill="none" filter="url(#fpwoh3eyej81u)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="290.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="266" y="177.6953"/><rect fill="#87CEFA" filter="url(#fpwoh3eyej81u)" height="112.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="528" y="246.0938"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="34.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="789" y="295.3594"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="789" y="409.8906"/><rect fill="#ADD8E6" filter="url(#fpwoh3eyej81u)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="789" y="541.5547"/><rect fill="#EEEEEE" filter="url(#fpwoh3eyej81u)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1045" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1045" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1045" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#fpwoh3eyej81u)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="130" x="457.5" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="463.5" y="124.3638">a) Key request</text><polygon fill="#0000FF" points="254,173.6953,264,177.6953,254,181.6953,258,177.6953" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="47" x2="260" y1="177.6953" y2="177.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="56.5" y="165.063">1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="145.5" y="157.4966">getKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="83.5" y="172.6294">(slave_SAE_ID, size, count)</text><path d="M212,192.6953 L340,192.6953 L340,199.6953 L330,209.6953 L212,209.6953 L212,192.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="173.9297" style="stroke:#000000;stroke-width:2.0;" width="790" x="212" y="192.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="227" y="205.7622">forwarding</text><polygon fill="#0000FF" points="516,242.0938,526,246.0938,516,250.0938,520,246.0938" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="276" x2="522" y1="246.0938" y2="246.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="285.5" y="233.4614">1.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="373" y="225.895">forwardData</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="316.5" y="241.0278">(enc_data, next_hop, dest, KID)</text><polygon fill="#0000FF" points="777,291.3594,787,295.3594,777,299.3594,781,295.3594" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="538" x2="783" y1="295.3594" y2="295.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="547.5" y="282.7271">1.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="634" y="275.1606">forwardData</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="577.5" y="290.2935">(enc_data, next_hop, dest, KID)</text><path d="M804,259.0938 L804,299.0938 L988,299.0938 L988,269.0938 L978,259.0938 L804,259.0938 " fill="#FBFB77" filter="url(#fpwoh3eyej81u)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M978,259.0938 L978,269.0938 L988,269.0938 L978,259.0938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="810" y="276.1606">enc_data encrypted with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="814" y="291.2935">a QKD derived key</text><polygon fill="#0000FF" points="549,325.4922,539,329.4922,549,333.4922,545,329.4922" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="543" x2="793" y1="329.4922" y2="329.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="629.5" y="324.4263">1.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="656.5" y="324.4263">&lt; OK &gt;</text><polygon fill="#0000FF" points="287,354.625,277,358.625,287,362.625,283,358.625" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="281" x2="532" y1="358.625" y2="358.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="368" y="353.5591">1.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="395" y="353.5591">&lt; OK &gt;</text><polygon fill="#0000FF" points="777,405.8906,787,409.8906,777,413.8906,781,409.8906" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="276" x2="783" y1="409.8906" y2="409.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="351.5" y="397.2583">1.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="504" y="389.6919">reserveKeys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="378.5" y="404.8247">( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )</text><polygon fill="#0000FF" points="287,435.0234,277,439.0234,287,443.0234,283,439.0234" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="281" x2="793" y1="439.0234" y2="439.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="494.5" y="433.9575">1.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="521.5" y="433.9575">&lt; ACK &gt;</text><polygon fill="#0000FF" points="58,464.1563,48,468.1563,58,472.1563,54,468.1563" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="270" y1="468.1563" y2="468.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="101" y="463.0903">1.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="128" y="463.0903">&lt; AKID, key &gt;</text><polygon fill="#FF0000" points="989,493.2891,999,497.2891,989,501.2891,993,497.2891" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="47" x2="995" y1="497.2891" y2="497.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="478" y="492.2231">1.9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="505" y="492.2231">send AKID</text><polygon fill="#0000FF" points="810,537.5547,800,541.5547,810,545.5547,806,541.5547" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="804" x2="1000" y1="541.5547" y2="541.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="808.5" y="528.9224">1.10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="869.5" y="521.356">getKeyWithIDs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="845.5" y="536.4888">(master_SAE_ID, AKID)</text><polygon fill="#0000FF" points="989,566.6875,999,570.6875,989,574.6875,993,570.6875" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="794" x2="995" y1="570.6875" y2="570.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="835" y="565.6216">1.11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="871" y="565.6216">&lt; AKID, key &gt;</text><!--MD5=[000e3a38cc7212f740f0577d0245c72b]
@startuml
skinparam sequenceMessageAlign center
actor "Alice's SAE" as ASAE order 1  #lightCoral
actor "Bob's SAE" as BSAE order 5  #lightCoral
participant "Alice's QKS" as AQKS order 2 #LightBlue
participant "Bob's QKS" as BQKS order 4 #LightBlue
participant "Carol's QKS" as CQKS order 3 #lightskyblue

== a) Key request == 
autonumber 1.1
ASAE -[#blue]> AQKS ++ #LightBlue: getKey \n(slave_SAE_ID, size, count) 

group forwarding
AQKS -[#blue]> CQKS ++ #lightskyblue: forwardData \n (enc_data, next_hop, dest, KID) 
CQKS -[#blue]> BQKS ++ #lightblue: forwardData \n (enc_data, next_hop, dest, KID) 
note right: enc_data encrypted with \n a QKD derived key 
BQKS -[#blue]-> CQKS - -: < OK >
CQKS -[#blue]-> AQKS - -: < OK >
end

AQKS -[#blue]> BQKS ++ #LightBlue:  reserveKeys \n( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )
BQKS -[#blue]-> AQKS - -: < ACK >
AQKS -[#blue]-> ASAE - - : < AKID, key >
ASAE -[#red]> BSAE : send AKID
BSAE -[#blue]> BQKS ++ #LightBlue: getKeyWithIDs \n(master_SAE_ID, AKID)
BQKS -[#blue]-> BSAE - -: < AKID, key >
@enduml

PlantUML version 1.2021.13beta8(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>