<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="941px" preserveAspectRatio="none" style="width:1047px;height:941px;background:#FFFFFF;" version="1.1" viewBox="0 0 1047 941" width="1047px" zoomAndPan="magnify"><defs><filter height="300%" id="fm4y4ju6cwafo" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="287.8945" style="stroke:#A80036;stroke-width:1.0;" width="10" x="266" y="175.1289"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="34.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="271" y="334.4922"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="185.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="266" y="550.4219"/><rect fill="#87CEFA" filter="url(#fm4y4ju6cwafo)" height="112.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="533" y="285.2266"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="217.0625" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="216.8281"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="41.6992" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="592.1211"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="678.0859"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="809.75"/><rect fill="#FFFFFF" filter="url(#fm4y4ju6cwafo)" height="173.9297" style="stroke:#000000;stroke-width:2.0;" width="643" x="212" y="231.8281"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="88.2969" y2="856.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="271" x2="271" y1="88.2969" y2="856.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="538" x2="538" y1="88.2969" y2="856.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="799" x2="799" y1="88.2969" y2="856.8828"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="996" x2="996" y1="88.2969" y2="856.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="5" y="84.9951">Alice's SAE</text><ellipse cx="47" cy="15" fill="#F08080" filter="url(#fm4y4ju6cwafo)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M47,23 L47,50 M34,31 L60,31 M47,50 L34,65 M47,50 L60,65 " fill="none" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="5" y="868.8779">Alice's SAE</text><ellipse cx="47" cy="882.1797" fill="#F08080" filter="url(#fm4y4ju6cwafo)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M47,890.1797 L47,917.1797 M34,898.1797 L60,898.1797 M47,917.1797 L34,932.1797 M47,917.1797 L60,932.1797 " fill="none" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="222" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="229" y="72.9951">Alice's QKS</text><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="222" y="855.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="229" y="875.8779">Alice's QKS</text><rect fill="#87CEFA" filter="url(#fm4y4ju6cwafo)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="488" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="495" y="72.9951">Carol's QKS</text><rect fill="#87CEFA" filter="url(#fm4y4ju6cwafo)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="96" x="488" y="855.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="495" y="875.8779">Carol's QKS</text><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="753" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="760" y="72.9951">Bob's QKS</text><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="753" y="855.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="760" y="875.8779">Bob's QKS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="957" y="84.9951">Bob's SAE</text><ellipse cx="996" cy="15" fill="#F08080" filter="url(#fm4y4ju6cwafo)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M996,23 L996,50 M983,31 L1009,31 M996,50 L983,65 M996,50 L1009,65 " fill="none" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="957" y="868.8779">Bob's SAE</text><ellipse cx="996" cy="882.1797" fill="#F08080" filter="url(#fm4y4ju6cwafo)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M996,890.1797 L996,917.1797 M983,898.1797 L1009,898.1797 M996,917.1797 L983,932.1797 M996,917.1797 L1009,932.1797 " fill="none" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="287.8945" style="stroke:#A80036;stroke-width:1.0;" width="10" x="266" y="175.1289"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="34.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="271" y="334.4922"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="185.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="266" y="550.4219"/><rect fill="#87CEFA" filter="url(#fm4y4ju6cwafo)" height="112.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="533" y="285.2266"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="217.0625" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="216.8281"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="41.6992" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="592.1211"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="678.0859"/><rect fill="#ADD8E6" filter="url(#fm4y4ju6cwafo)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="794" y="809.75"/><rect fill="#EEEEEE" filter="url(#fm4y4ju6cwafo)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1040" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1040" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1040" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#fm4y4ju6cwafo)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="258" x="391" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="239" x="397" y="124.3638">a) Indirect key stream creation</text><polygon fill="#0000FF" points="254,171.1289,264,175.1289,254,179.1289,258,175.1289" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="47" x2="260" y1="175.1289" y2="175.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="80.5" y="170.063">1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="107.5" y="170.063">getStatus (bobSAE)</text><path d="M281,146.4297 L281,186.4297 L505,186.4297 L505,156.4297 L495,146.4297 L281,146.4297 " fill="#FBFB77" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M495,146.4297 L495,156.4297 L505,156.4297 L495,146.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="287" y="163.4966">bobSAE non directly connected</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="291" y="178.6294">keyStream not found</text><polygon fill="#0000FF" points="782,212.8281,792,216.8281,782,220.8281,786,216.8281" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="276" x2="788" y1="216.8281" y2="216.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="381" y="211.7622">1.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="408" y="211.7622">createStream ( src, KSID, type, master_KID)</text><path d="M212,231.8281 L340,231.8281 L340,238.8281 L330,248.8281 L212,248.8281 L212,231.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="173.9297" style="stroke:#000000;stroke-width:2.0;" width="643" x="212" y="231.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83" x="227" y="244.895">forwarding</text><polygon fill="#0000FF" points="554,281.2266,544,285.2266,554,289.2266,550,285.2266" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="548" x2="793" y1="285.2266" y2="285.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="552.5" y="272.5942">1.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="639" y="265.0278">forwardData</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="582.5" y="280.1606">(enc_data, next_hop, dest, KID)</text><polygon fill="#0000FF" points="292,330.4922,282,334.4922,292,338.4922,288,334.4922" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="286" x2="532" y1="334.4922" y2="334.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="290.5" y="321.8599">1.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="378" y="314.2935">forwardData</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="321.5" y="329.4263">(enc_data, next_hop, dest, KID)</text><path d="M548,298.2266 L548,338.2266 L732,338.2266 L732,308.2266 L722,298.2266 L548,298.2266 " fill="#FBFB77" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M722,298.2266 L722,308.2266 L732,308.2266 L722,298.2266 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="554" y="315.2935">enc_data encrypted with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="558" y="330.4263">a QKD derived key</text><polygon fill="#0000FF" points="521,364.625,531,368.625,521,372.625,525,368.625" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="276" x2="527" y1="368.625" y2="368.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="368" y="363.5591">1.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="395" y="363.5591">&lt; OK &gt;</text><polygon fill="#0000FF" points="782,393.7578,792,397.7578,782,401.7578,786,397.7578" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="538" x2="788" y1="397.7578" y2="397.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="629.5" y="392.6919">1.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="656.5" y="392.6919">&lt; OK &gt;</text><polygon fill="#0000FF" points="287,429.8906,277,433.8906,287,437.8906,283,433.8906" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="281" x2="798" y1="433.8906" y2="433.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="497" y="428.8247">1.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="524" y="428.8247">&lt; ACK &gt;</text><polygon fill="#0000FF" points="58,459.0234,48,463.0234,58,467.0234,54,463.0234" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="270" y1="463.0234" y2="463.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="97.5" y="457.9575">1.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="124.5" y="457.9575">&lt; status info &gt;</text><rect fill="#EEEEEE" filter="url(#fm4y4ju6cwafo)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1040" x="0" y="491.5898"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1040" y1="491.5898" y2="491.5898"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1040" y1="494.5898" y2="494.5898"/><rect fill="#EEEEEE" filter="url(#fm4y4ju6cwafo)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="130" x="455" y="481.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="111" x="461" y="497.0903">b) Key request</text><polygon fill="#0000FF" points="254,546.4219,264,550.4219,254,554.4219,258,550.4219" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="47" x2="260" y1="550.4219" y2="550.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="56.5" y="537.7896">2.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45" x="145.5" y="530.2231">getKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="83.5" y="545.356">(slave_SAE_ID, size, count)</text><polygon fill="#0000FF" points="782,588.1211,792,592.1211,782,596.1211,786,592.1211" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="276" x2="788" y1="592.1211" y2="592.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="381" y="587.0552">2.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="408" y="587.0552">exchangeIndirectKey (KSID, KIDs, enc_keys)</text><path d="M72,563.4219 L72,603.4219 L257,603.4219 L257,573.4219 L247,563.4219 L72,563.4219 " fill="#FBFB77" filter="url(#fm4y4ju6cwafo)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M247,563.4219 L247,573.4219 L257,573.4219 L247,563.4219 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="78" y="580.4888">enc_keys encrypted with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="82" y="595.6216">the master key</text><polygon fill="#0000FF" points="287,629.8203,277,633.8203,287,637.8203,283,633.8203" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="281" x2="798" y1="633.8203" y2="633.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22" x="497.5" y="628.7544">2.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="523.5" y="628.7544">&lt; ACK &gt;</text><polygon fill="#0000FF" points="782,674.0859,792,678.0859,782,682.0859,786,678.0859" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="276" x2="788" y1="678.0859" y2="678.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="354" y="665.4536">2.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="506.5" y="657.8872">reserveKeys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="381" y="673.02">( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )</text><polygon fill="#0000FF" points="287,703.2188,277,707.2188,287,711.2188,283,707.2188" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="281" x2="798" y1="707.2188" y2="707.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="497" y="702.1528">2.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="524" y="702.1528">&lt; ACK &gt;</text><polygon fill="#0000FF" points="58,732.3516,48,736.3516,58,740.3516,54,736.3516" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="270" y1="736.3516" y2="736.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="101" y="731.2856">2.6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="128" y="731.2856">&lt; AKID, key &gt;</text><polygon fill="#FF0000" points="984,761.4844,994,765.4844,984,769.4844,988,765.4844" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="47" x2="990" y1="765.4844" y2="765.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="475.5" y="760.4185">2.7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="502.5" y="760.4185">send AKID</text><polygon fill="#0000FF" points="815,805.75,805,809.75,815,813.75,811,809.75" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="809" x2="995" y1="809.75" y2="809.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="813.5" y="797.1177">2.8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="864.5" y="789.5513">getKeyWithIDs</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="840.5" y="804.6841">(master_SAE_ID, AKID)</text><polygon fill="#0000FF" points="984,834.8828,994,838.8828,984,842.8828,988,838.8828" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="799" x2="990" y1="838.8828" y2="838.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="23" x="839.5" y="833.8169">2.9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="866.5" y="833.8169">&lt; AKID, key &gt;</text><!--MD5=[3739d9cf8eacdb67779293a231649956]
@startuml
skinparam sequenceMessageAlign center
actor "Alice's SAE" as ASAE order 1  #lightCoral
actor "Bob's SAE" as BSAE order 5  #lightCoral
participant "Alice's QKS" as AQKS order 2 #LightBlue
participant "Bob's QKS" as BQKS order 4 #LightBlue
participant "Carol's QKS" as CQKS order 3 #lightskyblue

== a) Indirect key stream creation == 
autonumber 1.1
ASAE -[#blue]> AQKS ++ #LightBlue: getStatus (bobSAE)
note right: bobSAE non directly connected \n keyStream not found 
AQKS -[#blue]> BQKS ++ #lightblue : createStream ( src, KSID, type, master_KID) 

group forwarding
BQKS -[#blue]> CQKS ++ #lightskyblue: forwardData \n (enc_data, next_hop, dest, KID) 
CQKS -[#blue]> AQKS ++ #lightblue: forwardData \n (enc_data, next_hop, dest, KID) 
note right: enc_data encrypted with \n a QKD derived key 
AQKS -[#blue]-> CQKS - -: < OK >
CQKS -[#blue]-> BQKS - -: < OK >
end

BQKS -[#blue]-> AQKS - -: < ACK > 
AQKS -[#blue]-> ASAE - -: < status info >


== b) Key request == 
autonumber inc A
ASAE -[#blue]> AQKS ++ #LightBlue: getKey \n(slave_SAE_ID, size, count) 
AQKS -[#blue]> BQKS ++ #LightBlue: exchangeIndirectKey (KSID, KIDs, enc_keys) 
note left: enc_keys encrypted with \n the master key
BQKS -[#blue]-> AQKS - -: < ACK >
AQKS -[#blue]> BQKS ++ #LightBlue:  reserveKeys \n( master_SAE_ID, slave_SAE_ID, size, {AKID, KIDs} )
BQKS -[#blue]-> AQKS - -: < ACK >
AQKS -[#blue]-> ASAE - - : < AKID, key >
ASAE -[#red]> BSAE : send AKID
BSAE -[#blue]> BQKS ++ #LightBlue: getKeyWithIDs \n(master_SAE_ID, AKID)
BQKS -[#blue]-> BSAE - -: < AKID, key >
@enduml

PlantUML version 1.2021.11beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>