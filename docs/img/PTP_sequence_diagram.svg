<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1650px" preserveAspectRatio="none" style="width:1490px;height:1650px;background:#FFFFFF;" version="1.1" viewBox="0 0 1490 1650" width="1490px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mzuw2c908g01" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="242.5" y="162.5625"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="242.5" y="726.8203"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="430.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="242.5" y="843.3516"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="322.2266"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="755.9531"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="872.4844"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="1173.6797"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="831.5" y="480.8906"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="831.5" y="1044.1484"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="831.5" y="1418.7422"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1153.5" y="220.8281"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="129.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1153.5" y="1015.0156"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="186.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1153.5" y="1332.3438"/><rect fill="#FFFFFF" filter="url(#f1mzuw2c908g01)" height="130.5313" style="stroke:#000000;stroke-width:2.0;" width="509" x="455.5" y="525.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="88.2969" y2="1566.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="247" x2="247" y1="88.2969" y2="1566.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="532.5" x2="532.5" y1="88.2969" y2="1566.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="836.5" x2="836.5" y1="88.2969" y2="1566.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1158" x2="1158" y1="88.2969" y2="1566.2734"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1446" x2="1446" y1="88.2969" y2="1566.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="5" y="84.9951">aliceSAE</text><ellipse cx="38.5" cy="15" fill="#F08080" filter="url(#f1mzuw2c908g01)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M38.5,23 L38.5,50 M25.5,31 L51.5,31 M38.5,50 L25.5,65 M38.5,50 L51.5,65 " fill="none" filter="url(#f1mzuw2c908g01)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="5" y="1578.2686">aliceSAE</text><ellipse cx="38.5" cy="1591.5703" fill="#F08080" filter="url(#f1mzuw2c908g01)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M38.5,1599.5703 L38.5,1626.5703 M25.5,1607.5703 L51.5,1607.5703 M38.5,1626.5703 L25.5,1641.5703 M38.5,1626.5703 L51.5,1641.5703 " fill="none" filter="url(#f1mzuw2c908g01)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="77" x="207" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="214" y="72.9951">aliceQKS</text><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="77" x="207" y="1565.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="214" y="1585.2686">aliceQKS</text><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="465.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="472.5" y="72.9951">aliceQKDModule</text><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="465.5" y="1565.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="472.5" y="1585.2686">aliceQKDModule</text><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="126" x="771.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="778.5" y="72.9951">bobQKDModule</text><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="126" x="771.5" y="1565.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="778.5" y="1585.2686">bobQKDModule</text><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="73" x="1120" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1127" y="72.9951">bobQKS</text><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="73" x="1120" y="1565.2734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1127" y="1585.2686">bobQKS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1415" y="84.9951">bobSAE</text><ellipse cx="1446.5" cy="15" fill="#F08080" filter="url(#f1mzuw2c908g01)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1446.5,23 L1446.5,50 M1433.5,31 L1459.5,31 M1446.5,50 L1433.5,65 M1446.5,50 L1459.5,65 " fill="none" filter="url(#f1mzuw2c908g01)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="1415" y="1578.2686">bobSAE</text><ellipse cx="1446.5" cy="1591.5703" fill="#F08080" filter="url(#f1mzuw2c908g01)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1446.5,1599.5703 L1446.5,1626.5703 M1433.5,1607.5703 L1459.5,1607.5703 M1446.5,1626.5703 L1433.5,1641.5703 M1446.5,1626.5703 L1459.5,1641.5703 " fill="none" filter="url(#f1mzuw2c908g01)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="242.5" y="162.5625"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="242.5" y="726.8203"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="430.7266" style="stroke:#A80036;stroke-width:1.0;" width="10" x="242.5" y="843.3516"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="100.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="322.2266"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="755.9531"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="872.4844"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="527.5" y="1173.6797"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="831.5" y="480.8906"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="831.5" y="1044.1484"/><rect fill="#90EE90" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="831.5" y="1418.7422"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1153.5" y="220.8281"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="129.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1153.5" y="1015.0156"/><rect fill="#ADD8E6" filter="url(#f1mzuw2c908g01)" height="186.7969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1153.5" y="1332.3438"/><rect fill="#EEEEEE" filter="url(#f1mzuw2c908g01)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1483" x="0" y="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1483" y1="118.8633" y2="118.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1483" y1="121.8633" y2="121.8633"/><rect fill="#EEEEEE" filter="url(#f1mzuw2c908g01)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="208" x="637.5" y="108.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="189" x="643.5" y="124.3638">QKD module registration</text><polygon fill="#0000FF" points="263.5,158.5625,253.5,162.5625,263.5,166.5625,259.5,162.5625" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="257.5" x2="531.5" y1="162.5625" y2="162.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="269.5" y="157.4966">RegisterModule( {module info} )</text><polygon fill="#0000FF" points="520.5,187.6953,530.5,191.6953,520.5,195.6953,524.5,191.6953" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="247.5" x2="526.5" y1="191.6953" y2="191.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="254.5" y="186.6294">&lt; init data for QM &gt;</text><polygon fill="#0000FF" points="1141.5,216.8281,1151.5,220.8281,1141.5,224.8281,1145.5,220.8281" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="836.5" x2="1147.5" y1="220.8281" y2="220.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="843.5" y="215.7622">RegisterModule( {module info} )</text><polygon fill="#0000FF" points="847.5,245.9609,837.5,249.9609,847.5,253.9609,843.5,249.9609" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="841.5" x2="1157.5" y1="249.9609" y2="249.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="853.5" y="244.895">&lt; init data for QM &gt;</text><rect fill="#EEEEEE" filter="url(#f1mzuw2c908g01)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1483" x="0" y="278.5273"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1483" y1="278.5273" y2="278.5273"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1483" y1="281.5273" y2="281.5273"/><rect fill="#EEEEEE" filter="url(#f1mzuw2c908g01)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="202" x="640.5" y="267.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183" x="646.5" y="284.0278">Quantum keys exchange</text><polygon fill="#008000" points="515.5,318.2266,525.5,322.2266,515.5,326.2266,519.5,322.2266" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="247.5" x2="521.5" y1="322.2266" y2="322.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="254.5" y="317.1606">OPEN_CONNECT (server_src, server_dst)</text><ellipse cx="537" cy="363.6094" rx="4" ry="4" style="stroke:#008000;stroke-width:1.5;fill:none;"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="537.5" x2="579.5" y1="351.3594" y2="351.3594"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="579.5" x2="579.5" y1="351.3594" y2="364.3594"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="542.5" x2="579.5" y1="364.3594" y2="364.3594"/><polygon fill="#008000" points="552.5,360.3594,542.5,364.3594,552.5,368.3594,548.5,364.3594" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="544.5" y="346.2935">generates KSID</text><polygon fill="#008000" points="824.5,389.4922,834.5,393.4922,824.5,397.4922,828.5,393.4922" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="537.5" x2="830.5" y1="393.4922" y2="393.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="544.5" y="388.4263">open_stream(server_src, server_dst, KSID)</text><polygon fill="#008000" points="258.5,418.625,248.5,422.625,258.5,426.625,254.5,422.625" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="252.5" x2="531.5" y1="422.625" y2="422.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="264.5" y="417.5591">&lt; KSID &gt;</text><polygon fill="#0000FF" points="1146.5,447.7578,1156.5,451.7578,1146.5,455.7578,1150.5,451.7578" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="247.5" x2="1152.5" y1="451.7578" y2="451.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="254.5" y="446.6919">createStream (server_src, KSID)</text><polygon fill="#008000" points="852.5,476.8906,842.5,480.8906,852.5,484.8906,848.5,480.8906" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="846.5" x2="1157.5" y1="480.8906" y2="480.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="858.5" y="475.8247">OPEN_CONNECT (server_src, server_dst, KSID)</text><polygon fill="#008000" points="1146.5,506.0234,1156.5,510.0234,1146.5,514.0234,1150.5,510.0234" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="836.5" x2="1152.5" y1="510.0234" y2="510.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="843.5" y="504.9575">&lt; KSID &gt;</text><path d="M455.5,525.0234 L533.5,525.0234 L533.5,532.0234 L523.5,542.0234 L455.5,542.0234 L455.5,525.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="130.5313" style="stroke:#000000;stroke-width:2.0;" width="509" x="455.5" y="525.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="470.5" y="538.0903">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="105" x="548.5" y="537.2339">[exchange keys]</text><polygon fill="#008000" points="824.5,559.2891,834.5,563.2891,824.5,567.2891,828.5,563.2891" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="532.5" x2="830.5" y1="563.2891" y2="563.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="539.5" y="558.2231">exchange (KSID)</text><ellipse cx="532" cy="604.6719" rx="4" ry="4" style="stroke:#008000;stroke-width:1.5;fill:none;"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="532.5" x2="574.5" y1="592.4219" y2="592.4219"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="574.5" x2="574.5" y1="592.4219" y2="605.4219"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="537.5" x2="574.5" y1="605.4219" y2="605.4219"/><polygon fill="#008000" points="547.5,601.4219,537.5,605.4219,547.5,609.4219,543.5,605.4219" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="539.5" y="587.356">save key in vault</text><ellipse cx="836" cy="646.8047" rx="4" ry="4" style="stroke:#008000;stroke-width:1.5;fill:none;"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="836.5" x2="878.5" y1="634.5547" y2="634.5547"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="878.5" x2="878.5" y1="634.5547" y2="647.5547"/><line style="stroke:#008000;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="841.5" x2="878.5" y1="647.5547" y2="647.5547"/><polygon fill="#008000" points="851.5,643.5547,841.5,647.5547,851.5,651.5547,847.5,647.5547" style="stroke:#008000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="843.5" y="629.4888">save key in vault</text><rect fill="#EEEEEE" filter="url(#f1mzuw2c908g01)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1483" x="0" y="683.1211"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1483" y1="683.1211" y2="683.1211"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1483" y1="686.1211" y2="686.1211"/><rect fill="#EEEEEE" filter="url(#f1mzuw2c908g01)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="202" x="640.5" y="672.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183" x="646.5" y="688.6216">SAE Key Exchange (PTP)</text><polygon fill="#0000FF" points="230.5,722.8203,240.5,726.8203,230.5,730.8203,234.5,726.8203" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="38.5" x2="236.5" y1="726.8203" y2="726.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="45.5" y="721.7544">getStatus (bobSAE)</text><polygon fill="#008000" points="515.5,751.9531,525.5,755.9531,515.5,759.9531,519.5,755.9531" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="252.5" x2="521.5" y1="755.9531" y2="755.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="259.5" y="750.8872">GET_KEY_ID(KSID)</text><polygon fill="#008000" points="263.5,781.0859,253.5,785.0859,263.5,789.0859,259.5,785.0859" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="257.5" x2="531.5" y1="785.0859" y2="785.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="269.5" y="780.02">&lt; kids &gt;</text><polygon fill="#0000FF" points="49.5,810.2188,39.5,814.2188,49.5,818.2188,45.5,814.2188" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="246.5" y1="814.2188" y2="814.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="55.5" y="809.1528">&lt; info &gt;</text><polygon fill="#0000FF" points="230.5,839.3516,240.5,843.3516,230.5,847.3516,234.5,843.3516" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="38.5" x2="236.5" y1="843.3516" y2="843.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="45.5" y="838.2856">getKey (bobSAE, size, count)</text><polygon fill="#008000" points="515.5,868.4844,525.5,872.4844,515.5,876.4844,519.5,872.4844" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="252.5" x2="521.5" y1="872.4844" y2="872.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="259.5" y="867.4185">GET_KEY_ID (KSID)</text><polygon fill="#008000" points="263.5,897.6172,253.5,901.6172,263.5,905.6172,259.5,901.6172" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="257.5" x2="531.5" y1="901.6172" y2="901.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="269.5" y="896.5513">&lt; kids &gt;</text><ellipse cx="252" cy="943" rx="4" ry="4" style="stroke:#0000FF;stroke-width:1.5;fill:none;"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="252.5" x2="294.5" y1="930.75" y2="930.75"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="294.5" x2="294.5" y1="930.75" y2="943.75"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="257.5" x2="294.5" y1="943.75" y2="943.75"/><polygon fill="#0000FF" points="267.5,939.75,257.5,943.75,267.5,947.75,263.5,943.75" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="259.5" y="925.6841">generates AKIDs</text><ellipse cx="252" cy="985.1328" rx="4" ry="4" style="stroke:#0000FF;stroke-width:1.5;fill:none;"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="252.5" x2="294.5" y1="972.8828" y2="972.8828"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="294.5" x2="294.5" y1="972.8828" y2="985.8828"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="257.5" x2="294.5" y1="985.8828" y2="985.8828"/><polygon fill="#0000FF" points="267.5,981.8828,257.5,985.8828,267.5,989.8828,263.5,985.8828" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="259.5" y="967.8169">save reserved AKIDs and kids</text><polygon fill="#0000FF" points="1141.5,1011.0156,1151.5,1015.0156,1141.5,1019.0156,1145.5,1015.0156" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="252.5" x2="1147.5" y1="1015.0156" y2="1015.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336" x="259.5" y="1009.9497">reserveKeys (aliceSAE, bobSAE, size, [AKIDs, [kids]])</text><polygon fill="#008000" points="852.5,1040.1484,842.5,1044.1484,852.5,1048.1484,848.5,1044.1484" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="846.5" x2="1152.5" y1="1044.1484" y2="1044.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="858.5" y="1039.0825">CHECK_KEY_IDs (KSID, kids)</text><polygon fill="#008000" points="1141.5,1069.2813,1151.5,1073.2813,1141.5,1077.2813,1145.5,1073.2813" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="836.5" x2="1147.5" y1="1073.2813" y2="1073.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="843.5" y="1068.2153">&lt; OK ACK &gt;</text><ellipse cx="1163" cy="1114.6641" rx="4" ry="4" style="stroke:#0000FF;stroke-width:1.5;fill:none;"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1163.5" x2="1205.5" y1="1102.4141" y2="1102.4141"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1205.5" x2="1205.5" y1="1102.4141" y2="1115.4141"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1168.5" x2="1205.5" y1="1115.4141" y2="1115.4141"/><polygon fill="#0000FF" points="1178.5,1111.4141,1168.5,1115.4141,1178.5,1119.4141,1174.5,1115.4141" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="1170.5" y="1097.3481">save reserved AKIDs and kids</text><polygon fill="#0000FF" points="263.5,1140.5469,253.5,1144.5469,263.5,1148.5469,259.5,1144.5469" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="257.5" x2="1157.5" y1="1144.5469" y2="1144.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76" x="269.5" y="1139.481">&lt; OK ACK &gt;</text><polygon fill="#008000" points="515.5,1169.6797,525.5,1173.6797,515.5,1177.6797,519.5,1173.6797" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="252.5" x2="521.5" y1="1173.6797" y2="1173.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="259.5" y="1168.6138">GET_KEY (KSID, kids)</text><polygon fill="#008000" points="263.5,1198.8125,253.5,1202.8125,263.5,1206.8125,259.5,1202.8125" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="257.5" x2="531.5" y1="1202.8125" y2="1202.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="269.5" y="1197.7466">&lt; keys, kids &gt;</text><ellipse cx="252" cy="1244.1953" rx="4" ry="4" style="stroke:#0000FF;stroke-width:1.5;fill:none;"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="252.5" x2="294.5" y1="1231.9453" y2="1231.9453"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="294.5" x2="294.5" y1="1231.9453" y2="1244.9453"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="257.5" x2="294.5" y1="1244.9453" y2="1244.9453"/><polygon fill="#0000FF" points="267.5,1240.9453,257.5,1244.9453,267.5,1248.9453,263.5,1244.9453" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="259.5" y="1226.8794">aggregate keys</text><polygon fill="#0000FF" points="49.5,1270.0781,39.5,1274.0781,49.5,1278.0781,45.5,1274.0781" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="246.5" y1="1274.0781" y2="1274.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="55.5" y="1269.0122">&lt; [AKID, key] &gt;</text><polygon fill="#FF0000" points="1434.5,1299.2109,1444.5,1303.2109,1434.5,1307.2109,1438.5,1303.2109" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="38.5" x2="1440.5" y1="1303.2109" y2="1303.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="45.5" y="1298.145">AKIDs</text><polygon fill="#0000FF" points="1174.5,1328.3438,1164.5,1332.3438,1174.5,1336.3438,1170.5,1332.3438" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="1168.5" x2="1445.5" y1="1332.3438" y2="1332.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="264" x="1180.5" y="1327.2778">getKeyWithKeyIDs (aliceSAE, AKIDs, size)</text><ellipse cx="1163" cy="1388.8594" rx="4" ry="4" style="stroke:#0000FF;stroke-width:1.5;fill:none;"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1163.5" x2="1205.5" y1="1376.6094" y2="1376.6094"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1205.5" x2="1205.5" y1="1376.6094" y2="1389.6094"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1168.5" x2="1205.5" y1="1389.6094" y2="1389.6094"/><polygon fill="#0000FF" points="1178.5,1385.6094,1168.5,1389.6094,1178.5,1393.6094,1174.5,1389.6094" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="1170.5" y="1356.4106">retrieve kids</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="1174.5" y="1371.5435">and aggregation data</text><polygon fill="#008000" points="852.5,1414.7422,842.5,1418.7422,852.5,1422.7422,848.5,1418.7422" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="846.5" x2="1152.5" y1="1418.7422" y2="1418.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="858.5" y="1413.6763">GET_KEY (KSID, kids)</text><polygon fill="#008000" points="1141.5,1443.875,1151.5,1447.875,1141.5,1451.875,1145.5,1447.875" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="836.5" x2="1147.5" y1="1447.875" y2="1447.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="843.5" y="1442.8091">&lt; keys, kids &gt;</text><ellipse cx="1163" cy="1489.2578" rx="4" ry="4" style="stroke:#0000FF;stroke-width:1.5;fill:none;"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1163.5" x2="1205.5" y1="1477.0078" y2="1477.0078"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1205.5" x2="1205.5" y1="1477.0078" y2="1490.0078"/><line style="stroke:#0000FF;stroke-width:1.0;fill:none;stroke-dasharray:2.0,2.0;" x1="1168.5" x2="1205.5" y1="1490.0078" y2="1490.0078"/><polygon fill="#0000FF" points="1178.5,1486.0078,1168.5,1490.0078,1178.5,1494.0078,1174.5,1490.0078" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="1170.5" y="1471.9419">aggregate keys</text><polygon fill="#0000FF" points="1434.5,1515.1406,1444.5,1519.1406,1434.5,1523.1406,1438.5,1519.1406" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1158.5" x2="1440.5" y1="1519.1406" y2="1519.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="1165.5" y="1514.0747">&lt; [AKID, key] &gt;</text><polygon fill="#FF0000" points="49.5,1544.2734,39.5,1548.2734,49.5,1552.2734,45.5,1548.2734" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="1434.5,1544.2734,1444.5,1548.2734,1434.5,1552.2734,1438.5,1548.2734" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="43.5" x2="1440.5" y1="1548.2734" y2="1548.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="55.5" y="1543.2075">&lt; Can communicate securely &gt;</text><!--MD5=[5be082ea38934e7f4d9cc8c216c810ba]
@startuml
actor aliceSAE as ASAE order 1 #lightCoral
actor bobSAE as BSAE order 6 #lightCoral
participant aliceQKS as AQKS order 2 #LightBlue
participant bobQKS as BQKS order 5 #LightBlue
participant aliceQKDModule as AQM order 3 #LightGreen
participant bobQKDModule as BQM order 4 #LightGreen

== QKD module registration ==


AQM -[#blue]> AQKS : RegisterModule( {module info} )
activate AQKS #LightBlue
AQKS -[#blue]-> AQM : < init data for QM >
deactivate AQKS 

BQM -[#blue]> BQKS : RegisterModule( {module info} )
activate BQKS #LightBlue
BQKS -[#blue]-> BQM : < init data for QM >
deactivate BQKS


== Quantum keys exchange == 
AQKS -[#green]> AQM : OPEN_CONNECT (server_src, server_dst)
activate AQM #LightGreen
AQM - -[#green]>o AQM : generates KSID
AQM -[#green]> BQM : open_stream(server_src, server_dst, KSID)
AQM - -[#green]> AQKS : < KSID >
deactivate AQM
AQKS -[#blue]> BQKS : createStream (server_src, KSID) 

BQKS -[#green]> BQM : OPEN_CONNECT (server_src, server_dst, KSID) 
activate BQM #LightGreen
BQM - -[#green]> BQKS : < KSID >
deactivate BQM
loop exchange keys
    AQM -[#green]> BQM : exchange (KSID)
    AQM - -[#green]>o AQM : save key in vault
    BQM - -[#green]>o BQM : save key in vault
end

== SAE Key Exchange (PTP) == 
ASAE -[#blue]> AQKS : getStatus (bobSAE)
activate AQKS #LightBlue
AQKS -[#green]> AQM : GET_KEY_ID(KSID)
activate AQM #LightGreen
AQM -[#green]-> AQKS : < kids >
deactivate AQM
AQKS -[#blue]-> ASAE : < info >
deactivate AQKS

ASAE -[#blue]> AQKS : getKey (bobSAE, size, count) 
activate AQKS #LightBlue
AQKS -[#green]> AQM : GET_KEY_ID (KSID)
activate AQM #LightGreen
AQM -[#green]->AQKS : < kids > 
deactivate AQM
AQKS -[#blue]->o AQKS : generates AKIDs
AQKS -[#blue]->o AQKS : save reserved AKIDs and kids
AQKS -[#blue]> BQKS : reserveKeys (aliceSAE, bobSAE, size, [AKIDs, [kids]]) 
activate BQKS #LightBlue
BQKS -[#green]> BQM : CHECK_KEY_IDs (KSID, kids)
activate BQM #LightGreen
BQM -[#green]-> BQKS : < OK ACK >
deactivate BQM
BQKS -[#blue]->o BQKS : save reserved AKIDs and kids
BQKS -[#blue]-> AQKS : < OK ACK >
deactivate BQKS 
 
AQKS -[#green]> AQM : GET_KEY (KSID, kids) 
activate AQM #LightGreen
AQM -[#green]-> AQKS : < keys, kids >
deactivate AQM 
AQKS -[#blue]->o AQKS : aggregate keys
AQKS -[#blue]-> ASAE : < [AKID, key] >
deactivate AQKS
ASAE -[#red]> BSAE :  AKIDs 
BSAE -[#blue]> BQKS : getKeyWithKeyIDs (aliceSAE, AKIDs, size)
activate BQKS #LightBlue
BQKS -[#blue]->o BQKS : retrieve kids \n and aggregation data
BQKS -[#green]> BQM : GET_KEY (KSID, kids) 
activate BQM #LightGreen
BQM -[#green]-> BQKS : < keys, kids > 
deactivate BQM
BQKS -[#blue]->o BQKS : aggregate keys
BQKS -[#blue]-> BSAE :  < [AKID, key] >
deactivate BQKS 
ASAE <-[#red]> BSAE: < Can communicate securely >
@enduml

PlantUML version 1.2021.7beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>